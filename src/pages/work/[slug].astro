---
import BaseLayout from '../../layouts/BaseLayout.astro';
import CaseStudyDetail from '../../components/CaseStudyDetail';
import { caseStudies } from '../../data/caseStudies';

export const getStaticPaths = () =>
  caseStudies.map((study) => ({
    params: { slug: study.slug },
  }));

const { slug } = Astro.params;
const caseStudy = caseStudies.find((study) => study.slug === slug);

if (!caseStudy) {
  return Astro.redirect('/#work', 302);
}

const relatedStudies = caseStudies
  .filter((study) => study.slug !== caseStudy.slug)
  .slice(0, 2);

const pageTitle = `${caseStudy.title.en} | Case Study Â· 2 Weeks to Solve It`;
---
<BaseLayout title={pageTitle} description={caseStudy.summary.en}>
  <CaseStudyDetail client:load caseStudy={caseStudy} relatedStudies={relatedStudies} />
</BaseLayout>
